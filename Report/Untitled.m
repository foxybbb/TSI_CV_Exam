% ??????: radialPowerSpectrumDemo.m
% ---------------------------------
% 1) ???????? ??? ????????? ????????? ???????????
% 2) ?????????? 2D-??????? ????????
% 3) ?????????? ??????? ?? ????????
% 4) ?????????? ??? ???????????????? ??????
% 5) ?????????? ??????? Power Spectrum (Y) vs Spatial Frequency (X)

clear; clc; close all;

%% 1) ???????? ???????????
% ?????? ????? ????? ??????????? ???? ??????? "img",
% ???? ????????? ?? ???????? "img = imread('myImage.tif');" ? ?.?.
N = 256;                           % ?????? ???????????
img = zeros(N);
img(N/2, N/2) = 1;                 % ??? ??????? — ????????????? "???????" ? ??????
% img = imread('myImage.tif');     % ??????, ???? ????????? ???????? ???????????
% img = double(img);               % ??????? ? double ??? ?????????????

%% 2) ?????????? 2D-??????? ????????
% ???????? FFT, ??????? ???? ?????? ? ?????, ?????? ??????? ??????
F   = fftshift(fft2(img));         % 2D-?????????????? ????? ?? ???????
PS  = abs(F).^2;                   % ?????? ????????

%% 3) ?????????? ??????????
radialMean = computeRadialMean(PS);  % ???????? ??????? (????)

%% 4) ??? ???????????????? ??????
% ???????????, ??? pixelSize = 1 (????????? ???????).
% ????? ???????????? ?????? = floor(min(N,N)/2).
% ???? ??????? ????? ???????? ?????? (????????, ?x = 0.1 ???),
% ?? spatialFrequency(r) = (r / (N*?x)), ???????? ?? ????????? 2?-??????? ??? ?????? ??????? ??????.
maxRadius = length(radialMean);
pixelSize  = 1;                    % ???? ???????? ???????? ?????? ???????, ??????? ??? ?????
spatialFrequency = (0:maxRadius-1) / (N * pixelSize); 

%% 5) ?????????? ???????
figure('Name','Radial Power Spectrum','NumberTitle','off');
plot(spatialFrequency, radialMean, 'LineWidth', 2);
xlabel('Spatial Frequency (1/pixel)');
ylabel('Power Spectrum (arb. units)');
title('Radial (Azimuthal) Average of the 2D Power Spectrum');
grid on;
